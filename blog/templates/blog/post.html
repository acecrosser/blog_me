{% extends "base.html" %}
{% load selfilters %}
{% load static %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}

    <h1>{{ post.title }}</h1>
    <p class="fs-6" style="color: #D3D3D3">{{ post.update|date }}</p>
    {% for tag in post.tags.all %}
        <span class="badge rounded-pill bg-info text-dark">{{ tag }}</span>
    {% endfor %}
    <div class="mt-2 container">
    {{ post.body|markdown }}
    </div>

    <hr class="bg-black" />

    {% if user.is_authenticated %}
        <a href="{% url 'blog:edit_post' post.slug %}">Редактировать</a>
    {% endif %}

    <div class="row mt-2">
        <div class="col-1 mb-2" data-id="{{ post.id }}" data-type="blogpost" data-action="like" title="Нравится">
            <img src="{% static 'images/hand-thumbs-up-fill.svg'%}" height="20px">
            <span data-count="like">{{ post.votes.likes.count }}</span>
        </div>
        <div class="col-1 mb-2" data-id="{{ post.id }}" data-type="blogpost" data-action="dislike" title="Не нравится">
            <img src="{% static 'images/hand-thumbs-down-fill.svg'%}" height="20px">
            <span data-count="dislike">{{ post.votes.dislikes.count }}</span>
        </div>
        <div class="offset-md-7 col">
            <p>Рубрика - <a href="{% url 'blog:rubric' post.rubric_name.slug %}">{{ post.rubric_name }}</a></p>
        </div>
    </div>

    {% for cmnt in comments %}
    <div class="mt-3 mb-3 card text-">
        <div class="card-header">{{ cmnt.author }}</div>
        <div class="card-body">
            <blockquote class="blockquote mb-0">
                <p class="fs-6">{{ cmnt.comment }}</p>
                <footer class="fs-6 blockquote-footer">{{ cmnt.create }}</footer>
            </blockquote>
        </div>
    </div>
    {% endfor %}

    <div class="mb-3">
        <form method="post">
                {% csrf_token %}
                <label class="form-label">Ваше имя</label>
                {{ comment_form.author }}
                <label class="form-label mt-2">Комментарий</label>
                {{ comment_form.comment }}
                {{ comment_form.captcha }}<br>
            <button type="submit" class="btn btn-light mt-3">Комментировать</button>
        </form>
    </div>

    <script src="{% static 'js/LikeDislike.js' %}"></script>
{% endblock %}